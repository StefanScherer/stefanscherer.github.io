<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>How to run lightweight Windows Containers on Windows 10</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=f77927fe81" />


    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/amp/" />
    
    <meta property="og:site_name" content="Stefan Scherer&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to run lightweight Windows Containers on Windows 10" />
    <meta property="og:description" content="When you follow my blog for a while you probably know that running Windows Containers on Windows 10 had some disadvantages compared to a Windows Server. On Windows 10 every Windows Containers has to be run in Hyper-V isolation mode. Process Isolation With the latest release of Docker Desktop on" />
    <meta property="og:url" content="https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/" />
    <meta property="article:published_time" content="2019-01-18T08:23:21.000Z" />
    <meta property="article:modified_time" content="2019-01-18T08:23:22.000Z" />
    <meta property="article:tag" content="Windows 10" />
    <meta property="article:tag" content="windows-containers" />
    <meta property="article:tag" content="Docker Desktop" />
    <meta property="article:tag" content="Docker" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to run lightweight Windows Containers on Windows 10" />
    <meta name="twitter:description" content="When you follow my blog for a while you probably know that running Windows Containers on Windows 10 had some disadvantages compared to a Windows Server. On Windows 10 every Windows Containers has to be run in Hyper-V isolation mode. Process Isolation With the latest release of Docker Desktop on" />
    <meta name="twitter:url" content="https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Stefan Scherer" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Windows 10, windows-containers, Docker Desktop, Docker" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Stefan Scherer&#x27;s Blog",
        "logo": "https://stefanscherer.github.io/favicon.ico"
    },
    "author": {
        "@type": "Person",
        "name": "Stefan Scherer",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/0c09487dd4b63737bd5004333230a77b?s=250&d=mm&r=x",
            "width": 2054,
            "height": 516
        },
        "url": "https://stefanscherer.github.io/author/stefan/",
        "sameAs": []
    },
    "headline": "How to run lightweight Windows Containers on Windows 10",
    "url": "https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/",
    "datePublished": "2019-01-18T08:23:21.000Z",
    "dateModified": "2019-01-18T08:23:22.000Z",
    "keywords": "Windows 10, windows-containers, Docker Desktop, Docker",
    "description": "When you follow my blog for a while you probably know that running Windows Containers on Windows 10 had some disadvantages compared to a Windows Server. On Windows 10 every Windows Containers has to be run in Hyper-V isolation mode. Process Isolation With the latest release of Docker Desktop on",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://stefanscherer.github.io/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.min.js?v=f77927fe81"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "fcf9918858bf"
});
</script>
    <meta name="generator" content="Ghost 1.8" />
    <link rel="alternate" type="application/rss+xml" title="Stefan Scherer&#x27;s Blog" href="https://stefanscherer.github.io/rss/" />
</head>
<body class="post-template tag-windows-10 tag-windows-containers tag-docker-desktop tag-docker nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home"><a href="https://stefanscherer.github.io/">Home</a></li>
            <li class="nav-talks"><a href="https://stefanscherer.github.io/talks/">Talks</a></li>
            <li class="nav-twitter"><a href="https://twitter.com/stefscherer">Twitter</a></li>
            <li class="nav-github"><a href="https://github.com/StefanScherer">GitHub</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="https://stefanscherer.github.io/rss/">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-windows-10 tag-windows-containers tag-docker-desktop tag-docker">

        <header class="post-header">
            <h1 class="post-title">How to run lightweight Windows Containers on Windows 10</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2019-01-18">18 January 2019</time>  on <a href="../tag/windows-10/">Windows 10</a>, <a href="../tag/windows-containers/">windows-containers</a>, <a href="../tag/docker-desktop/">Docker Desktop</a>, <a href="../tag/docker/">Docker</a>
            </section>
        </header>

        <section class="post-content">
            <div class="kg-card-markdown"><p>When you follow my blog for a while you probably know that running Windows Containers on Windows 10 had some disadvantages compared to a Windows Server. On Windows 10 every Windows Containers has to be run in Hyper-V isolation mode.</p>
<h2 id="processisolation">Process Isolation</h2>
<p>With the latest release of Docker Desktop on Windows 10 1809 you now can run Windows Containers in process isolation mode. What's the benefit you might think.</p>
<p><img src="../content/images/2019/01/docker-desktop-2-0-0-2.png" alt="docker-desktop-2-0-0-2"></p>
<p>In the past process isolation was only possible with Windows Server. The Windows 10 operating system uses the same kernel, but with different settings. With this pull request <a href="https://github.com/moby/moby/pull/38000">https://github.com/moby/moby/pull/38000</a> that got merged into Docker 18.09.1 it is now possible to use it on Windows 10 as well.</p>
<ul>
<li>You can start more Windows Containers on your machine as they consume less resources</li>
<li>Containers normally start faster than in hyperv isolation mode</li>
<li>You can &quot;see&quot; the isolated processes and what they are doing</li>
</ul>
<h2 id="visiblecontainerprocesses">Visible container processes</h2>
<p>Especially for developers this is a great enhancement, because you now can use tools like Task Manager, Process Monitor and others to inspect your container processes from the host. I've blogged <a href="https://stefanscherer.github.io/find-dependencies-in-windows-containers/">How to find dependencies of containerized Windows apps</a> about a year ago. Now you do not longer need to spin up a Windows Server VM to do that, your Windows 10 machine is all you need.</p>
<p>Let's try this out with a small web server I have created for the <a href="https://chocolateyfest.com">Chocolatey Fest</a> conference last October that's running in a Windows Nanoserver 2019 container.</p>
<p>Open up a PowerShell terminal and start a Windows container with this command</p>
<pre><code>docker run -d -p 8080:8080 --isolation=process chocolateyfest/appetizer:1.0.0
</code></pre>
<p>The command will pull the Docker image from <a href="https://hub.docker.com/r/chocolateyfest/appetizer">Docker Hub</a>, starts the web server as a container and forwards port 8080 to it.</p>
<p>Now you can access the web server with your browser or by typing this command</p>
<pre><code>start http://localhost:8080
</code></pre>
<p>The web server should show you a sweet photo and the name of the container stamped on it.</p>
<p><img src="../content/images/2019/01/windows-10-process-isolation.png" alt="windows-10-process-isolation"></p>
<p>As you can see in the screen shot you can see the <code>node.exe</code> process in the Task Manager. If you have the Sysinternals Process Monitor installed you also can see what the containerized process is doing. This is great when you create an own Docker image from your or a 3rd-party app and something doesn't work as expected or the exe file just doesn't want to start inside the container.</p>
<h2 id="windowsimageversionmustmatchkernelversion">Windows image version must match kernel version</h2>
<p>The only caveat using the process isolation mode is that the Windows base image that is used for a Docker image must match the kernel of your Windows 10 machine.</p>
<p>I've tried process isolation on a Windows Insider 18xxx machine, but here you are out of luck and you have to run the 1809 images in default Hyper-V isolation mode.</p>
<h2 id="canirunwindowscontainersinvirtualbox">Can I run Windows Containers in VirtualBox?</h2>
<p>I run all these tests in VMware Fusion on my Mac, spinning up a <a href="https://github.com/StefanScherer/windows-docker-desktop-box">Windows 10 1809 VM with Vagrant</a>. You can try it yourself with the given <code>Vagrantfile</code> in the repo.</p>
<p>For a full Docker Desktop experience you need VMware Fusion as it provides nested virtualization. This is needed to activate Hyper-V in the Windows 10 VM. Docker Desktop runs fine in that VMware VM and you can try out Linux and Windows containers in it.</p>
<p>From time to time I get asked if people can also use VirtualBox. In the past I had to say &quot;no&quot; you can't use a Windows 10 VM and then run Windows Containers in it. But with process isolation there is a first breakthrough.</p>
<h3 id="dangerzoneforearlyadopters">Danger zone for early adopters</h3>
<p>I've tried that with VirtualBox to see what happens. The installation of Docker Desktop works without a problem. When you start Docker Desktop for the first time the following error will appear</p>
<p><img src="../content/images/2019/01/win10-virtualbox-linux-error.png" alt="win10-virtualbox-linux-error"></p>
<p>Sure, Hyper-V does not work in a VirtualBox VM, that's why the MobyLinuxVM could not be started. But now you can switch to Windows containers in the context menu.</p>
<p><img src="../content/images/2019/01/win10-switch-to-windows-container.png" alt="win10-switch-to-windows-container"></p>
<p>After a few seconds the Windows Docker engine is up and running. Open a PowerShell terminal and run the appetizer app as described above.</p>
<p><img src="../content/images/2019/01/win10-virtualbox-windows-container.png" alt="win10-virtualbox-windows-container"></p>
<p>Voila! It works.</p>
<p>Try something different with an interactive nanoserver container with a CMD shell</p>
<pre><code>docker run -it --isolation=process mcr.microsoft.com/windows/nanoserver:1809 cmd
</code></pre>
<h2 id="tldr">TL/DR</h2>
<p>Beginning with Windows 10 1809 and Docker 18.09.1 you can use the more lightweight process isolation mode for Windows Containers. Linux Containers still need Hyper-V installed to run them in Docker Desktop.</p>
<p>If you liked this blog post please share it with your friends. You can follow me on Twitter <a href="https://twitter.com/stefscherer">@stefscherer</a>.</p>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../author/stefan/" style="background-image: url(http://www.gravatar.com/avatar/0c09487dd4b63737bd5004333230a77b?s&)"><span class="hidden">Stefan Scherer's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../author/stefan/">Stefan Scherer</a></h4>

                    <p>Read <a href="../author/stefan/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=How%20to%20run%20lightweight%20Windows%20Containers%20on%20Windows%2010&amp;url=https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://stefanscherer.github.io/how-to-run-lightweight-windows-containers-on-windows-10/"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//stefanscherersblog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="../joining-docker/">
        <section class="post">
            <h2>Joining Docker</h2>
            <p>Today is my first day working for Docker, Inc. and I'm absolutely excited to be there. After months of&hellip;</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="../how-to-install-docker-the-chocolatey-way/">
        <section class="post">
            <h2>How to install Docker the Chocolatey way</h2>
            <p>When I'm working with Windows I love to have a standarized way to install software. Did you remember how&hellip;</p>
        </section>
    </a>
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="https://stefanscherer.github.io">Stefan Scherer&#x27;s Blog</a> &copy; 2020</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=f77927fe81"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=f77927fe81"></script>

</body>
</html>
