<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Yes, you can &quot;Docker&quot; on Windows 7</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=0134792829" />


    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/amp/" />
    
    <meta property="og:site_name" content="Stefan Scherer&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Yes, you can &quot;Docker&quot; on Windows 7" />
    <meta property="og:description" content="This week I was asked to help automating a task to get some Linux binaries and files packaged into a tarball. Some developers tried to spin up a Linux virtual machine and run a script to install tools and then do the packaging. Although I also like and use Vagrant" />
    <meta property="og:url" content="https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/" />
    <meta property="article:published_time" content="2017-03-31T17:02:07.000Z" />
    <meta property="article:modified_time" content="2017-07-25T12:09:13.000Z" />
    <meta property="article:tag" content="Docker" />
    <meta property="article:tag" content="Chocolatey" />
    <meta property="article:tag" content="Windows 7" />
    <meta property="article:tag" content="Docker Machine" />
    <meta property="article:tag" content="VMware" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Yes, you can &quot;Docker&quot; on Windows 7" />
    <meta name="twitter:description" content="This week I was asked to help automating a task to get some Linux binaries and files packaged into a tarball. Some developers tried to spin up a Linux virtual machine and run a script to install tools and then do the packaging. Although I also like and use Vagrant" />
    <meta name="twitter:url" content="https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Stefan Scherer" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Docker, Chocolatey, Windows 7, Docker Machine, VMware" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Stefan Scherer&#x27;s Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://stefanscherer.github.io/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Stefan Scherer",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/0c09487dd4b63737bd5004333230a77b?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://stefanscherer.github.io/author/stefan/",
        "sameAs": []
    },
    "headline": "Yes, you can &quot;Docker&quot; on Windows 7",
    "url": "https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/",
    "datePublished": "2017-03-31T17:02:07.000Z",
    "dateModified": "2017-07-25T12:09:13.000Z",
    "keywords": "Docker, Chocolatey, Windows 7, Docker Machine, VMware",
    "description": "This week I was asked to help automating a task to get some Linux binaries and files packaged into a tarball. Some developers tried to spin up a Linux virtual machine and run a script to install tools and then do the packaging. Although I also like and use Vagrant",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://stefanscherer.github.io/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.min.js?v=0134792829"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "fcf9918858bf"
});
</script>
    <meta name="generator" content="Ghost 1.8" />
    <link rel="alternate" type="application/rss+xml" title="Stefan Scherer&#x27;s Blog" href="https://stefanscherer.github.io/rss/" />
</head>
<body class="post-template tag-docker tag-chocolatey tag-windows-7 tag-docker-machine tag-vmware nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home"><a href="https://stefanscherer.github.io/">Home</a></li>
            <li class="nav-talks"><a href="https://stefanscherer.github.io/talks/">Talks</a></li>
            <li class="nav-twitter"><a href="https://twitter.com/stefscherer">Twitter</a></li>
            <li class="nav-github"><a href="https://github.com/StefanScherer">GitHub</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="https://stefanscherer.github.io/rss/">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-docker tag-chocolatey tag-windows-7 tag-docker-machine tag-vmware">

        <header class="post-header">
            <h1 class="post-title">Yes, you can &quot;Docker&quot; on Windows 7</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2017-03-31">31 March 2017</time>  on <a href="../tag/docker/">Docker</a>, <a href="../tag/chocolatey/">Chocolatey</a>, <a href="../tag/windows-7/">Windows 7</a>, <a href="../tag/docker-machine/">Docker Machine</a>, <a href="../tag/vmware/">VMware</a>
            </section>
        </header>

        <section class="post-content">
            <div class="kg-card-markdown"><p>This week I was asked to help automating a task to get some Linux binaries and files packaged into a tarball. Some developers tried to spin up a Linux virtual machine and run a script to install tools and then do the packaging. Although I also like and use <a href="https://www.vagrantup.com">Vagrant</a> still very often, it seemed to me using <a href="https://www.docker.com">Docker</a> will be easier to maintain as this could be done in a one-shot container.</p>
<h2 id="thehardfactswindows7enterprise">The hard facts - Windows 7 Enterprise</h2>
<p>The bigger problem was the fact that in some companies you still find Windows 7 Enterprise. It may be a delayed rollout of new notebooks that keep the employees on that old desktop platform.</p>
<p>So using <a href="https://docs.docker.com/docker-for-windows/">Docker for Windows</a> was no option as it only works with Windows 10 Pro with Hyper-V. This looks like a good setup for new notebooks, but if you want to use Docker <em>now</em> you have to look for other solutions.</p>
<h2 id="lockedinhypervisor">Locked-in Hypervisor</h2>
<p>Next obstacle was that for Vagrant it is better to use <strong>VMware Workstation</strong> on Windows 7 instead of VirtualBox. There also may be a company policy to use one specific hypervisor as the knowledge is already there using other server products in the datacenter.</p>
<p>So going down to the <a href="https://www.docker.com/products/docker-toolbox">Docker Toolbox</a> also was no option as it comes with VirtualBox to run the Linux boot2docker VM.</p>
<blockquote class="twitter-tweet" data-lang="de"><p lang="en" dir="ltr">Can&#39;t Believe this..GOT THIS GIF from my Kid :) <a href="https://twitter.com/docker">@docker</a> ..Amazing ! <a href="https://t.co/f09henl5Ta">pic.twitter.com/f09henl5Ta</a></p>&mdash; Ajeet Singh Raina (@ajeetsraina) <a href="https://twitter.com/ajeetsraina/status/847737267510591488">31. MÃ¤rz 2017</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<h2 id="embraceyourenvironment">Embrace your environment</h2>
<p>So we went with a manual installation of some Docker tools to get a Linux Docker VM running on the Windows 7 machine. Luckily the developers already had the <a href="https://chocolatey.org">Chocolatey</a> package manager installed.</p>
<p>Let's recap what I found on the notebooks</p>
<ul>
<li>Windows 7 Enterprise</li>
<li>VMware Workstation 9/10/11/12</li>
</ul>
<p>Well there is a tool Docker Machine to create local Docker VM's very easily, and there is a VMware Workstation plugin available. All these tools are also available as Chocolatey packages.</p>
<p>So what we did on the machines was installing three packages with these simple commands in an administrator terminal.</p>
<pre><code>choco install -y docker
choco install -y docker-machine
choco install -y docker-machine-vmwareworkstation
</code></pre>
<p>Then we closed the administrator terminal as the next commands can be done in normal user mode.</p>
<h2 id="myhostismycastle">My host is my castle</h2>
<p>Every developer installs tools that they need for their work. Installing that on the host machine - your desktop or notebook - leads to different machines.</p>
<p>Creating the Docker Machine we ran into a &quot;works on my machine, but doesn't work on your machine&quot; problem I hadn't seen before.</p>
<p>Something while setting up the Linux VM just went wrong. It turned out that copying the Docker TLS certs with SSH just didn't work. A deeper look on what else is installed on the host we found that some implementations of SSH clients just doesn't work very well.</p>
<p>Luckily there is a less known option in the <code>docker-machine</code> binary to ignore external SSH client and use the built-in implementation.</p>
<p>With that knowledge we were able to create a VMware Docker Machine on that laptop with</p>
<pre><code>docker-machine --native-ssh create -d vmwareworkstation default
</code></pre>
<p>Using the good old PowerShell on the Windows 7 notebook helps you to use that Linux Docker VM by setting some environment variables.</p>
<pre><code>docker-machine env | iex
</code></pre>
<p>After that you can run <code>docker version</code> for example to retrieve client and server version which are both the up-to-date community editions</p>
<p><img src="../content/images/2017/03/docker-version.png" alt="docker version"></p>
<p>Quite exciting to be able to use that Windows 7 notebook with the latest Docker tools installed.</p>
<p>So hopefully Docker and using containers in more and more development tasks helps to keep their notebooks clean and they <strong>install less tools on the host</strong> and instead running more tools in containers.</p>
<h2 id="icancaproblem">I can C: a problem</h2>
<p>Using that Docker Machine VM worked really well until we faced another problem. Building some Docker images we ran out of disk space. Oh no, although the Windows 7 notebooks got improved by installing a 1 TB SSD, the C: partition hasn't been increased for some historical reasons.</p>
<p><img src="../content/images/2017/03/facepalm.jpg" alt="Face palm"></p>
<p>Docker Machine creates the Linux VM's in the current users home directory. This is a good idea, but having a 120 GB partition with only 7 GB left on C: we had to fix it. Taking a deep breath and embracing that environment, we came to the following solution.</p>
<p>We destroyed the Docker Machine again (because it's so easy) and also removed the <code>.docker</code> folder again to link it to a folder that resides on a bigger partition of the SSD.</p>
<pre><code>docker-machine rm -f default
rm $env:USERPROFILE\.docker
mkdir D:\docker
cmd /c mklink /J $env:USERPROFILE\.docker D:\docker
</code></pre>
<p>Then we recreated the Docker Machine with the command from above and set the environment variables again.</p>
<pre><code>docker-machine --native-ssh create -d vmwareworkstation default
docker-machine env | iex
</code></pre>
<p>And hurray - it worked. The VM with its disk resides on the bigger D: drive and we don't have to set any other global environment variables.</p>
<p>With that setup I made the developers happy. They could start using Docker without waiting for new hardware or asking their admins to resize or reformat their partitions.</p>
<p>We soon had a small <code>Dockerfile</code> and put the already existing provision scripts into an image. So we finished the task running a Linux container that can be thrown away more easily than a whole VM.</p>
<h2 id="dailywork">Daily work</h2>
<p>To recap how to use this Docker Machine you normally do the following steps after booting your notebook.</p>
<pre><code>docker-machine start
docker-machine env | iex
</code></pre>
<p>Then you can work with this default Linux Docker VM.</p>
<h2 id="planningyourhardwareupdate">Planning your hardware update</h2>
<p>The story ended well, but I recommended to think ahead and plan the next hardware update. So before they just get the new notebook generation they should think about which hypervisor they should use in the future.</p>
<p>Using Windows 10 Enterprise with the built-in Hyper-V would be easier. You can run <strong>native Windows containers</strong> with it and use <strong>Docker for Windows</strong> to switch between Linux and Windows containers. Using Vagrant with Hyper-V also gets better and better.</p>
<p>But if company policy still restricts you to use eg. VMware then you also can use the steps above to create a Linux Docker machine. You also cannot use Windows containers directly on Windows 10 machine as Hyper-V does not work in parallel with other hypervisors. In that case you might spin up a Windows Server 2016 VM using my <a href="https://github.com/StefanScherer/windows-docker-machine">Windows Docker Machine</a> setup. With that you can easily switch between Linux and Windows containers using the <code>docker-machine env</code> command.</p>
<p>As always, please leave a comment if you have questions or improvements or want to share your thoughts. I love to hear about your enterprise setup and how to make Docker work on your developer's machines. You can follow me on Twitter <a href="https://twitter.com/stefscherer">@stefscherer</a>.</p>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../author/stefan/" style="background-image: url(http://www.gravatar.com/avatar/0c09487dd4b63737bd5004333230a77b?s&)"><span class="hidden">Stefan Scherer's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../author/stefan/">Stefan Scherer</a></h4>

                    <p>Read <a href="../author/stefan/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Yes%2C%20you%20can%20%22Docker%22%20on%20Windows%207&amp;url=https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://stefanscherer.github.io/yes-you-can-docker-on-windows-7/"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//stefanscherersblog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="../use-multi-stage-builds-for-smaller-windows-images/">
        <section class="post">
            <h2>Use multi-stage builds for smaller Windows images</h2>
            <p>I'm still here in Austin, TX at DockerCon 2017 and I want to show you one of the announcements&hellip;</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="../7-reasons-to-attend-dockercon/">
        <section class="post">
            <h2>7 Reasons to attend DockerCon</h2>
            <p>I'm more than happy that I can make it to DockerCon in Austin, Texas. It is only a few&hellip;</p>
        </section>
    </a>
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="https://stefanscherer.github.io">Stefan Scherer&#x27;s Blog</a> &copy; 2018</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=0134792829"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=0134792829"></script>

</body>
</html>
