<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>First impressions of Docker on Windows 2016 TP5</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=4f5d64f6ae">


    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/amp/">
    
    <meta property="og:site_name" content="Stefan Scherer's Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="First impressions of Docker on Windows 2016 TP5">
    <meta property="og:description" content="Yesterday Microsoft announced the availabilty of the Windows 2016 Technical Preview 5. Sure I had to get in touch with that new toy as soon as possible to see what has changed since TP4 that was released in November 2015. As I haven't found an Azure template (update: today I">
    <meta property="og:url" content="https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/">
    <meta property="article:published_time" content="2016-04-29T00:11:03.000Z">
    <meta property="article:modified_time" content="2016-05-22T21:22:28.000Z">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="First impressions of Docker on Windows 2016 TP5">
    <meta name="twitter:description" content="Yesterday Microsoft announced the availabilty of the Windows 2016 Technical Preview 5. Sure I had to get in touch with that new toy as soon as possible to see what has changed since TP4 that was released in November 2015. As I haven't found an Azure template (update: today I">
    <meta name="twitter:url" content="https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Stefan Scherer">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Stefan Scherer&#x27;s Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://stefanscherer.github.io/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Stefan Scherer",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/0c09487dd4b63737bd5004333230a77b?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://stefanscherer.github.io/author/stefan/",
        "sameAs": []
    },
    "headline": "First impressions of Docker on Windows 2016 TP5",
    "url": "https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/",
    "datePublished": "2016-04-29T00:11:03.000Z",
    "dateModified": "2016-05-22T21:22:28.000Z",
    "description": "Yesterday Microsoft announced the availabilty of the Windows 2016 Technical Preview 5. Sure I had to get in touch with that new toy as soon as possible to see what has changed since TP4 that was released in November 2015. As I haven&#x27;t found an Azure template (update: today I",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://stefanscherer.github.io/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.min.js?v=4f5d64f6ae"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "fcf9918858bf"
});
</script>
    <meta name="generator" content="Ghost 1.8">
    <link rel="alternate" type="application/rss+xml" title="Stefan Scherer's Blog" href="https://stefanscherer.github.io/rss/index.rss">
</head>
<body class="post-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home"><a href="https://stefanscherer.github.io/">Home</a></li>
            <li class="nav-talks"><a href="https://stefanscherer.github.io/talks/">Talks</a></li>
            <li class="nav-twitter"><a href="https://twitter.com/stefscherer">Twitter</a></li>
            <li class="nav-github"><a href="https://github.com/StefanScherer">GitHub</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="https://stefanscherer.github.io/rss/index.rss">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post">

        <header class="post-header">
            <h1 class="post-title">First impressions of Docker on Windows 2016 TP5</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-04-29">29 April 2016</time> 
            </section>
        </header>

        <section class="post-content">
            <div class="kg-card-markdown"><p>Yesterday Microsoft announced the availabilty of the Windows 2016 Technical Preview 5. Sure I had to get in touch with that new toy as soon as possible to see what has changed since TP4 that was released in November 2015.</p>
<p>As I haven't found an Azure template (<strong>update:</strong> today I found <a href="https://portal.azure.com/?feature.intlpolyfill=true#blade/Microsoft_Azure_Marketplace/GalleryFeaturedMenuItemBlade/selectedMenuItemId/home/searchQuery/Windows%20Server%202016%20Technical%20Preview%205">Windows Server 2016 Technical Preview 5</a>), I prepared my packer templates in <a href="https://github.com/stefanscherer/packer-windows/tree/tp5">a tp5 branch</a> that still need some changes to automatically build and install Docker and the Docker base images.</p>
<p><img src="../content/images/2016/04/Bildschirmfoto-2016-04-27-um-21-18-51.png" alt="packer build"></p>
<p>Even without a 100% solution this was a good first starting point build a first Vagrant box to start with and to do the remaining steps from <a href="https://msdn.microsoft.com/virtualization/windowscontainers/deployment/deployment?f=255&amp;MSPPError=-2147217396">Container Host Deployment - Windows Server</a> manually.</p>
<p>I'm really addicted to the automation workflow</p>
<ol>
<li><code>packer build</code></li>
<li><code>vagrant box add</code></li>
<li><code>vagrant up</code></li>
<li><code>vagrant destroy -f</code></li>
</ol>
<p>because you won't do it only once to build and have such a test environment. But setting it up is the hard way.</p>
<p>If you are impatient to wait for a complete packer template you can follow Arun Gupta's steps to build a <a href="http://blog.couchbase.com/2016/april/setup-docker-windows-server-2016">TP5 VM in VirtualBox</a>.</p>
<p>Now let's see what's new in the Technical Preview 5.</p>
<h2 id="wayfasternomoresleep">Way faster - no more sleep</h2>
<p>Building some Docker images with one of the Windows Dockerfiles I tested with TP4 are now <strong>much faster</strong> and as well you do not need to do the workaround of sleeping some seconds in each <code>RUN</code> command. Just remove this and forget about it.</p>
<h2 id="ipadressescanbeinspected">IP adresses can be inspected</h2>
<p>One of the obstacles porting the <a href="https://github.com/docker/docker-birthday-3/pull/165">Docker Birthday app to TP4 Windows containers</a> was the missing ability to fetch the IP adress of each container.</p>
<p>Running <code>docker inspect</code> now shows the IP address of the container.</p>
<p><img src="../content/images/2016/04/Bildschirmfoto-2016-04-27-um-22-33-29.png" alt="container ip address"></p>
<p>I will have to test whether the links in a <code>docker-compose.yml</code> file will work as well to set up a simple multi container app using simple host names.</p>
<p>But that's a good improvement of the networking in Windows containers.</p>
<h2 id="npipeisyourunixsocket">npipe is your unix socket</h2>
<p>Another interesting thing is that the Docker engine now listens to a Windows named pipe, just like a Unix socket on Linux.</p>
<p>This leads to a very unixish behavior that you have to be "sudo" to run docker commands:</p>
<p>Running the docker client without adminstratotion rights you can't connect to it.</p>
<p><img src="../content/images/2016/04/Bildschirmfoto-2016-04-28-um-00-01-29.png" alt=""></p>
<p>There is a way to allow specific users to use this named pipe just like on Linux adding users to the docker group, but I haven't found out the group name for this short test.</p>
<h2 id="kitematicmeetswindowsagain">Kitematic meets Windows (again)</h2>
<p>At this evening I also played with Docker for Windows Beta in a parallel VM and installed Kitematic there. As the Beta uses Kitematic without VirtualBox I thought this should also work well with TP5. So I took the ZIP file from the Beta download and tweaked my TP5 installation a little bit to make Kitematic talk to the Window Docker Engine.</p>
<p>My very pragmatic way to make this work was to add the local TCP port 2375 to the Docker Engine by editing the start script</p>
<pre><code>notepad C:\ProgramData\docker\runDockerDaemon.cmd
</code></pre>
<p>and change the dockerd command to <code>dockerd -H npipe:// -H 127.0.0.1:2375</code> and then run</p>
<pre><code>restart-service docker
</code></pre>
<p>The downloaded version of Kitematic for the Beta also searches for <code>docker.local</code>, so I added the loopback IP address to the host table with</p>
<pre><code>notepad C:\Windows\system32\drivers\etc\hosts
</code></pre>
<p><img src="../content/images/2016/04/Bildschirmfoto-2016-04-28-um-00-23-13.png" alt="kitematic-on-tp5"></p>
<p>Now Kitematic starts up without creating a local VM and shows the local Windows containers on the left side.</p>
<p>There's a lot more to explore in TP5 as you now can <strong>pull and push</strong> Docker Images from and to the Docker Hub.</p>
<p>So stay tuned of upcoming blog posts. With the TP5 the community can follow the progress of Docker on Windows much better and can check the latest improvements and pull requests of the Windows Docker Engine.</p>
<p>If you find this blog post useful, just share it with your friends and colleages. Please leave a comment if you have questions or improvements. You can follow me on Twitter <a href="https://twitter.com/stefscherer">@stefscherer</a>.</p>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../author/stefan/" style="background-image: url(http://www.gravatar.com/avatar/0c09487dd4b63737bd5004333230a77b?s&amp;)"><span class="hidden">Stefan Scherer's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../author/stefan/">Stefan Scherer</a></h4>

                    <p>Read <a href="../author/stefan/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=First%20impressions%20of%20Docker%20on%20Windows%202016%20TP5&amp;url=https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://stefanscherer.github.io/first-impressions-of-windows-2016-tp5/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//stefanscherersblog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="../setup-local-windows-2016-tp5-docker-vm/">
        <section class="post">
            <h2>Setup a local Windows 2016 TP5 Docker VM</h2>
            <p>It is great to see that more and more people are starting to test Windows Docker containers. The latest…</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="../build-docker-swarm-for-windows-the-docker-way/">
        <section class="post">
            <h2>Build Docker Swarm binary for Windows the "Docker way"</h2>
            <p>In my last blog post I showed how to run a Windows Docker Swarm. That tutorial just used a…</p>
        </section>
    </a>
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="https://stefanscherer.github.io">Stefan Scherer's Blog</a> © 2018</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=4f5d64f6ae"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=4f5d64f6ae"></script>

</body>
</html>